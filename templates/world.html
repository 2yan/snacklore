<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Map - Snacklore</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/header.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pages.css') }}">
</head>
<body class="standalone-body">
    {% include 'includes/header.html' %}
    <div class="world-container">
        <h1 class="standalone-h1">World Map</h1>
        
        <div class="world-map-placeholder">
            üåç World Map
        </div>
        
        <div class="countries-section">
            <div class="countries-header-wrapper">
                <h2 class="world-section-title">Countries</h2>
                <div class="world-search-wrapper">
                    <input type="text" id="country-search" class="world-search-input" placeholder="Search countries..." aria-label="Search countries">
                    <select id="country-sort" class="world-sort-select" aria-label="Sort countries">
                        <option value="name">Sort by Name</option>
                        <option value="recipes">Sort by Recipe Count</option>
                    </select>
                </div>
            </div>
            {% if countries %}
            <div class="countries-grid" id="countries-grid">
                {% for country in countries %}
                <div class="country-card" data-country-name="{{ country.name.lower() }}" data-recipe-count="{{ country.recipes|length if country.recipes else 0 }}">
                    <a href="{{ url_for('view_country', country_slug=country.name|country_slug) }}">{{ country.name }}</a>
                    <span class="country-recipe-count">({{ country.recipes|length if country.recipes else 0 }} recipes)</span>
                </div>
                {% endfor %}
            </div>
            <div id="no-results" class="country-empty-state" style="display: none;">No countries found matching your search.</div>
            {% else %}
            <div class="country-empty-state">
                <p>No countries available at this time.</p>
            </div>
            {% endif %}
        </div>
    </div>
    <script>
        const searchInput = document.getElementById('country-search');
        const sortSelect = document.getElementById('country-sort');
        const countriesGrid = document.getElementById('countries-grid');
        const noResults = document.getElementById('no-results');
        const countryCards = Array.from(document.querySelectorAll('.country-card'));
        
        function filterAndSortCountries() {
            const searchTerm = searchInput.value.toLowerCase().trim();
            const sortBy = sortSelect.value;
            
            let filtered = countryCards.filter(card => {
                const countryName = card.dataset.countryName || '';
                return countryName.includes(searchTerm);
            });
            
            // Sort
            if (sortBy === 'name') {
                filtered.sort((a, b) => {
                    const nameA = a.dataset.countryName || '';
                    const nameB = b.dataset.countryName || '';
                    return nameA.localeCompare(nameB);
                });
            } else if (sortBy === 'recipes') {
                filtered.sort((a, b) => {
                    const countA = parseInt(a.dataset.recipeCount || '0');
                    const countB = parseInt(b.dataset.recipeCount || '0');
                    return countB - countA;
                });
            }
            
            // Hide all cards
            countryCards.forEach(card => {
                card.style.display = 'none';
            });
            
            // Show filtered cards
            filtered.forEach(card => {
                card.style.display = '';
            });
            
            // Show/hide no results message
            if (filtered.length === 0 && searchTerm !== '') {
                noResults.style.display = 'block';
                if (countriesGrid) countriesGrid.style.display = 'none';
            } else {
                noResults.style.display = 'none';
                if (countriesGrid) countriesGrid.style.display = 'grid';
            }
        }
        
        if (searchInput) {
            searchInput.addEventListener('input', filterAndSortCountries);
        }
        if (sortSelect) {
            sortSelect.addEventListener('change', filterAndSortCountries);
        }
    </script>
</body>
</html>

